#개 209종
# \
#     "Affenpinscher,Afghan Hound,Airedale Terrier,Akita,Alaskan Malamute,American English Coonhound,American Eskimo Dog," \
#     "American Foxhound,American Pit Bull Terrier,American Water Spaniel,Anatolian Shepherd Dog,Appenzeller Sennenhunde," \
#     "Australian Cattle Dog,Australian Shepherd,Australian Terrier,Azawakh,Barbet,Basenji,Basset Hound,Beagle,Bearded Collie," \
#     "Bedlington Terrier,Belgian Malinois,Belgian Sheepdog,Belgian Tervuren,Berger Picard,Bernese Mountain Dog," \
#     "Bichon Frise,Black and Tan Coonhound,Black Russian Terrier,Bloodhound,Bluetick Coonhound,Bolognese,Border Collie," \
#     "Border Terrier,Borzoi,Boston Terrier,Bouvier des Flandres,Boxer,Boykin Spaniel,Bracco Italiano,Briard,Brittany," \
#     "Brussels Griffon,Bull Terrier,Bulldog,Bullmastiff,Cairn Terrier,Canaan Dog,Cane Corso,Cardigan Welsh Corgi," \
#     "Catahoula Leopard Dog,Cavalier King Charles Spaniel,Cesky Terrier,Chesapeake Bay Retriever,Chihuahua,Chinese Crested," \
#     "Chinese Shar-Pei,Chinook,Chow Chow,Clumber Spaniel,Cockapoo,Cocker Spaniel,Collie,Coton de Tulear," \
#     "Curly-Coated Retriever,Dachshund,Dalmatian,Dandie Dinmont Terrier,Doberman Pinscher,Dogue de Bordeaux," \
#     "English Cocker Spaniel,English Foxhound,English Setter,English Springer Spaniel,English Toy Spaniel," \
#     "Entlebucher Mountain Dog,Field Spaniel,Finnish Lapphund,Finnish Spitz,Flat-Coated Retriever,Fox Terrier," \
#     "French Bulldog,German Pinscher,German Shepherd Dog,German Shorthaired Pointer,German Wirehaired Pointer,Giant Schnauzer," \
#     "Glen of Imaal Terrier,Goldador,Golden Retriever,Goldendoodle,Gordon Setter,Great Dane,Great Pyrenees," \
#     "Greater Swiss Mountain Dog,Greyhound,Harrier,Havanese,Ibizan Hound,Icelandic Sheepdog,Irish Red and White Setter," \
#     "Irish Setter,Irish Terrier,Irish Water Spaniel,Irish Wolfhound,Italian Greyhound,Jack Russell Terrier," \
#     "Japanese Chin,Korean Jindo Dog,Keeshond,Kerry Blue Terrier,Komondor,Kooikerhondje,Kuvasz,Labradoodle,Labrador Retriever," \
#     "Lakeland Terrier,Lancashire Heeler,Leonberger,Lhasa Apso,Lowchen,Maltese,Maltese Shih Tzu,Maltipoo,Manchester Terrier," \
#     "Mastiff,Miniature Pinscher,Miniature Schnauzer,Mutt,Neapolitan Mastiff,Newfoundland,Norfolk Terrier,Norwegian Buhund," \
#     "Norwegian Elkhound,Norwegian Lundehund,Norwich Terrier,Nova Scotia Duck Tolling Retriever,Old English Sheepdog,Otterhound," \
#     "Papillon,Peekapoo,Pekingese,Pembroke Welsh Corgi,Petit Basset Griffon Vendeen,Pharaoh Hound,Plott,Pocket Beagle,Pointer," \
#     "Polish Lowland Sheepdog,Pomeranian,Poodle,Portuguese Water Dog,Pug,Puggle,Puli,Pyrenean Shepherd,Rat Terrier," \
#     "Redbone Coonhound,Rhodesian Ridgeback, Rottweiler,Saint Bernard,Saluki,Samoyed,Schipperke,Schnoodle,Scottish Deerhound," \
#     "Scottish Terrier,Sealyham Terrier,Shetland Sheepdog,Shiba Inu,Shih Tzu,Siberian Husky,Silky Terrier,Skye Terrier," \
#     "Sloughi,Small Munsterlander Pointer,Soft Coated Wheaten Terrier,Stabyhoun,Staffordshire Bull Terrier,Standard Schnauzer," \
#     "Sussex Spaniel,Swedish Vallhund,Tibetan Mastiff,Tibetan Spaniel,Tibetan Terrier,Toy Fox Terrier," \
#     "Treeing Tennessee Brindle,Treeing Walker Coonhound,Vizsla,Weimaraner,Welsh Springer Spaniel,Welsh Terrier," \
#     "West Highland White Terrier,Whippet Wirehaired Pointing Griffon,Xoloitzcuintli,Yorkipoo,Yorkshire Terrier"

# 고양이 49종
# \
#     "Abyssinian,American Bobtail,American Curl,American Shorthair,American Wirehair,Balinese,Bengal Cats,Birman,Bombay," \
#     "British Shorthair,Burmese,Burmilla,Chartreux,Chinese Li Hua,Colorpoint Shorthair,Cornish Rex,Cymric,Devon Rex," \
#     "Egyptian Mau,European Burmese,Exotic,Havana Brown,Himalayan,Japanese Bobtail,Javanese,Korat,LaPerm,Maine Coon," \
#     "Manx,Nebelung,Norwegian Forest,Ocicat,Oriental,Persian,Ragamuffin,Ragdoll Cats,Russian Blue,Savannah,Scottish Fold," \
#     "Selkirk Rex,Siamese Cat,Siberian,Singapura,Snowshoe,Somali,Sphynx,Tonkinese,Turkish Angora,Turkish Van"


# 꽃 종류
# \
#     "Anemone,Amaryllis,Amaranthus,Aster,Azalea,Gypsophila,Begonia,Campanula,Monarda didyma,Strelitzia," \
#     "Hyacinthoides non-scripta,Callistemon,Ranunculus,Camellia,Dianthus caryophyllus,Sakura," \
#     "Chrysanthemum,Aquilegia,Clover,Crocus,Bellis perennis,Dahlia,Narcissus,Delphinium,Leontopodium alpinum," \
#     "Primulaceae,Myosotis,Digitalis,Freesia,Gerbera,Gladiolus,Hibiscus,Hyacinthus,Holly,Cypripedioideae," \
#     "Lavender,Syringa,Lilium,Nelumbo,Tagetes,Marjoram,Mimosa,Narcissus,Choisya,Orchidaceae,Peach Blossom," \
#     "Peony,Petunia,Rhododendron,Rosemary,Salvia,Antirrhinum,Helianthus annuus,Tansy,Thistle,Thyme," \
#     "Nymphaea Odorata,Zinnia"


# 버섯 종류
# "Button mushroom,Chanterelle,Cremini,Fly Amanita,Destroying Angel,Giant Puffball," \
#                      "Green-spored Lepiota,Horn of Plenty,Jack-O-Lantern mushroom,Lactarius or milk mushroom," \
#                      "Meadow mushroom,Morel,Portabello,Russula mushroom,Shaggy mane," \
#                      "Slippery jack,Smooth white Lepiota,Sulfur or Chicken mushroom"


#뱀
# "Python family,Anaconda,Vipers,Tianoboa,Cobras,Mamba,Boas," \
#                      "Taipan,Garter snake,Colubridae,Rattlesnake,Kingsnakes,Acanthophis," \
#                      "Elapidae,Flying tree snakes,Anilius,Sunbeam snakes,Mole snakes,Ninia,Ahaetulla nasuta"

import urllib.request
from  bs4 import BeautifulSoup
from selenium import webdriver #웹 애플리케이션의 테스트를 자동화하기 위한 프레임워크
from selenium.webdriver.common.keys import Keys
import time #중간중간 sleep을 걸어야해서 time모듈을 import한다.

class googleImageCrawler():

    __CHROMDRIVER_PATH = "C:\\Users\\dahan\\Downloads\\"
    __DATA_PATH = "C:\\Users\\dahan\\Downloads\\"
    __URL = "https://www.google.com/imghp?hl=en"
    __KEYWORD_LIST = "Python family snakes,Anaconda snakes,Vipers snakes,Tianoboa snakes,Cobras snakes,Mamba,Boas snakes," \
                     "Taipan snakes,Garter snake,Colubridae snakes,Rattlesnake snakes,Kingsnakes snakes,Acanthophis snakes," \
                     "Elapidae snakes,Flying tree snakes,Anilius snakes,Sunbeam snakes,Mole snakes,Ahaetulla nasuta snakes"


    def __init__(self):
        self.driver = webdriver.Chrome(googleImageCrawler.__CHROMDRIVER_PATH + 'chromedriver')
        self.keyword_list = googleImageCrawler.__KEYWORD_LIST.split(',')
        self.scrollDown_count = 12
        self.image_num = 1
        self.driver.get(googleImageCrawler.__URL)
        self.playCrawling()

    def playCrawling(self):
        count = len(self.keyword_list)
        for _ in range(count):
            try:
                if len(self.keyword_list) != 0:
                    self.searchKeyword()
                    self.scrollDown()
                    images = self.scrapingImage()
                    self.saveImage(images)
                else:
                    self.driver.quit()
                    return
            except:
                print("Exception 발생")
                continue

    def searchKeyword(self):
        keyword = self.keyword_list.pop()
        print("Image search: {}".format(keyword))
        elem = self.driver.find_element_by_id("lst-ib")
        elem.send_keys(keyword)
        elem.submit()
        elem = self.driver.find_element_by_id("lst-ib")
        elem.clear()


    def clickMoreButton(self):

        self.driver.find_element_by_id('smb').send_keys(Keys.ENTER)

    def scrollDown(self):
        for i in range(0, self.scrollDown_count):
            time.sleep(1.5)
            self.driver.find_element_by_xpath("//body").send_keys(Keys.END)
            if i==2:
                try:
                    time.sleep(1)
                    self.clickMoreButton()
                except:
                    continue


    def scrapingImage(self):
        html = self.driver.page_source
        soup = BeautifulSoup(html, "html.parser")
        params = []
        imgList = soup.find_all("img", class_="rg_ic rg_i")

        for im in imgList:
            try:
                params.append(im["src"])
            except:
                continue
        return params

    def saveImage(self, images):

        for image in images:
            # 다운받을 폴더경로 입력
            urllib.request.urlretrieve(image, googleImageCrawler.__DATA_PATH + str(self.image_num) + ".jpg")
            self.image_num += 1


Crawler = googleImageCrawler()